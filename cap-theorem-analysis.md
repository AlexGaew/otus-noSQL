# CAP-теорема и классификация СУБД

**CAP-теорема** — это утверждение о том, что распределенная система может удовлетворять одновременно двум из трех свойств: **consistency**, **availability** и **partition tolerance**.

---

## MongoDB

MongoDB — это популярная NoSQL СУБД, или система управления базами данных, которая предназначена для хранения больших объемов данных в формате документов.  
Она отличается от традиционных реляционных баз данных, так как использует документо-ориентированную модель вместо таблиц с фиксированной структурой.  
MongoDB позволяет работать с гибкими данными, легко масштабируется и поддерживает высокую производительность.

MongoDB обеспечивает **strong consistency**, потому что это система с одним Master-узлом, и все записи идут по умолчанию в него.  
Автоматическая смена мастера происходит в случае отделения его от остальных узлов.  

В случае разделения сети система прекратит принимать записи до тех пор, пока не убедится, что может безопасно завершить их.  
Таким образом, система может продолжать работу в случае разделения сети, но теряется CAP-availability всех узлов.  

Это **CP-система**.

---

## Cassandra

Cassandra — это нереляционная отказоустойчивая распределенная СУБД, рассчитанная на создание высокомасштабируемых и надёжных хранилищ огромных массивов данных, представленных в виде хэша.

Отсутствие центрального узла лишает Cassandra главного недостатка, свойственного системам master/slave, в которых отказывает весь кластер при сбое главного сервера (Master Node).  
В кластере Cassandra все узлы равноценны между собой и, если один из них отказал, его функции возьмет на себя какой-то из оставшихся.

Благодаря такой децентрализации Apache Cassandra отлично подходит для географически распределенных систем с высокой доступностью, расположенных в разных датацентрах.  

Однако, при всех преимуществах такой гибко масштабируемой архитектуры, она обусловливает особенности операций чтения и записи, а также накладывает ряд существенных ограничений на использование этой СУБД в реальных Big Data проектах.

Предназначена для «скоростного» взаимодействия (low-latency interactions).  
ACID на уровне записи.  
В случае распределенной системы — it's all about that BASE.

Если возникает разрыв связи, остальные узлы продолжают функционировать.  
В случае нормального функционирования система использует уровни согласованности для уменьшения задержки.  

Система рассматривается как **PA**.

---

## PostgreSQL

PostgreSQL — это реляционная система управления базами данных (РСУБД).  
Это означает, что это система управления данными, представленными в виде отношений (relation).  
Отношение — это математически точное обозначение таблицы.

PostgreSQL в базовой конфигурации обеспечивает строгую согласованность и доступность, но при сетевых сбоях в кластере жертвует устойчивостью к разделению.  
Это значит, что при потере связи между нодами PostgreSQL стремится сохранить целостность данных (ACID), даже если это временно нарушит работу.

PostgreSQL — реляционная СУБД, использующая строгую модель ACID (Atomicity, Consistency, Isolation, Durability).

CAP-характеристика: в основном **CA**.  
Хотя в распределенных конфигурациях часто достигается баланс между **CP** (согласованность и устойчивость).

При сбоях сети между мастером и репликами PostgreSQL отдает приоритет согласованности (C) и доступности (A), не допуская расхождения данных (dirty reads), что делает его типичным представителем систем, требующих высокой надежности данных, а не постоянной доступности, как в NoSQL.

---

## Вывод

- MongoDB — **CP-система**
- PostgreSQL — **CA-система**
- Cassandra — **PA-система**
